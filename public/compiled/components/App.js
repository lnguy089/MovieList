import movies from '../defaultData.js';
import movieTitlesList from './movieTitlesList.js';
import MovieNames from './MovieNames.js';
import Form from './Form.js';
import Watched from './Watched.js';
import MovieList from './MovieNames.js';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      titles: [],
      choose: [],
      unwatchedList: [],
      watchedList: []
    };
    this.showUW = this.showUW.bind(this);
    this.showW = this.showW.bind(this);
    this.getMovies = this.getMovies.bind(this);
  }

  getMovies() {
    var arr = [];
    axios.get('https://api.themoviedb.org/3/movie/popular?api_key=6e1ecf08722aad46043b9a2cd2f982ee&language=en-US&page=1').then(response => {
      response.data.results.map((item, key) => {
        arr.push({
          id: item.id,
          title: item.original_title,
          date: item.release_date,
          picture: 'https://image.tmdb.org/t/p/w500' + item.poster_path
        });
      });
      this.setState({
        titles: arr,
        unwatchedList: arr
      }, () => {
        this.setState({
          choose: this.state.titles
        });
      }); // https://image.tmdb.org/t/p/w500
    }).catch(err => {
      console.log('could not get movies');
      console.log(err);
    });
  }

  sendMovies() {
    axios.post('/api/movies', this.state.choose).then(response => {
      console.log('package DELIVERED');
    }).catch(err => {
      console.log('NOOOOOOO');
    });
  }

  chooseMovie(movie) {
    this.setState({
      choose: movie
    });
  }

  addMovie(movie) {
    this.setState({
      titles: [...this.state.titles, movie],
      unwatchedList: [...this.state.unwatchedList, movie]
    });
  }

  addToWatched(movie) {
    this.setState({
      watchedList: [...this.state.watchedList, movie]
    });
  }

  addToUnWatched(movie) {
    this.setState({
      unwatchedList: [...this.state.unwatchedList, movie]
    });
  }

  removeFromUnWatchedWArr(key) {
    var newArr = [...this.state.unwatchedList];
    console.log(this.state.titles);
    var index = newArr.indexOf(this.state.unwatchedList[key]);

    if (index !== -1) {
      newArr.splice(index, 1);
      this.setState({
        unwatchedList: newArr
      });
    }
  }

  removeFromWatchedArr(key) {
    var newArr = [...this.state.watchedList];
    var index = newArr.indexOf(this.state.watchedList[key]);

    if (index !== -1) {
      newArr.splice(index, 1);
      this.setState({
        watchedList: newArr
      });
    }
  }

  showUW() {
    this.setState({
      choose: this.state.unwatchedList
    });
  }

  showW() {
    this.setState({
      choose: this.state.watchedList
    });
  }

  componentDidMount() {
    this.getMovies();
    this.sendMovies();
  }

  render() {
    return /*#__PURE__*/React.createElement("h2", {
      className: "link-container"
    }, /*#__PURE__*/React.createElement(Form, {
      movies: this.state.titles,
      searchMovie: this.chooseMovie.bind(this),
      addMovie: this.addMovie.bind(this)
    }), /*#__PURE__*/React.createElement("div", {
      className: "ls"
    }, "MovieList"), /*#__PURE__*/React.createElement("button", {
      onClick: () => this.sendMovies.bind(this)
    }, "SendMovies"), /*#__PURE__*/React.createElement("button", {
      onClick: () => this.showW()
    }, "Watched"), /*#__PURE__*/React.createElement("button", {
      onClick: () => this.showUW()
    }, "Unwatched"), /*#__PURE__*/React.createElement(MovieList, {
      movieTitle: this.state.choose,
      addToWatched: this.addToWatched.bind(this),
      addToUnWatched: this.addToUnWatched.bind(this),
      removeW: this.removeFromWatchedArr.bind(this),
      removeUW: this.removeFromUnWatchedWArr.bind(this)
    }));
  }

}

;
export default App; //
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL0FwcC5qc3giXSwibmFtZXMiOlsibW92aWVzIiwibW92aWVUaXRsZXNMaXN0IiwiTW92aWVOYW1lcyIsIkZvcm0iLCJXYXRjaGVkIiwiTW92aWVMaXN0IiwiQXBwIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwic3RhdGUiLCJ0aXRsZXMiLCJjaG9vc2UiLCJ1bndhdGNoZWRMaXN0Iiwid2F0Y2hlZExpc3QiLCJzaG93VVciLCJiaW5kIiwic2hvd1ciLCJnZXRNb3ZpZXMiLCJhcnIiLCJheGlvcyIsImdldCIsInRoZW4iLCJyZXNwb25zZSIsImRhdGEiLCJyZXN1bHRzIiwibWFwIiwiaXRlbSIsImtleSIsInB1c2giLCJpZCIsInRpdGxlIiwib3JpZ2luYWxfdGl0bGUiLCJkYXRlIiwicmVsZWFzZV9kYXRlIiwicGljdHVyZSIsInBvc3Rlcl9wYXRoIiwic2V0U3RhdGUiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzZW5kTW92aWVzIiwicG9zdCIsImNob29zZU1vdmllIiwibW92aWUiLCJhZGRNb3ZpZSIsImFkZFRvV2F0Y2hlZCIsImFkZFRvVW5XYXRjaGVkIiwicmVtb3ZlRnJvbVVuV2F0Y2hlZFdBcnIiLCJuZXdBcnIiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJyZW1vdmVGcm9tV2F0Y2hlZEFyciIsImNvbXBvbmVudERpZE1vdW50IiwicmVuZGVyIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxNQUFQLE1BQW1CLG1CQUFuQjtBQUNBLE9BQU9DLGVBQVAsTUFBNEIsc0JBQTVCO0FBQ0EsT0FBT0MsVUFBUCxNQUF1QixpQkFBdkI7QUFDQSxPQUFPQyxJQUFQLE1BQWlCLFdBQWpCO0FBQ0EsT0FBT0MsT0FBUCxNQUFvQixjQUFwQjtBQUNBLE9BQU9DLFNBQVAsTUFBc0IsaUJBQXRCOztBQUNBLE1BQU1DLEdBQU4sU0FBa0JDLEtBQUssQ0FBQ0MsU0FBeEIs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QUFLZ0MsY0FBTCxDQUFvQmhDLElBQXBCLENBQXlCLElBQXpCLENBQXRHO0FBQXNJLE1BQUEsT0FBTyxFQUFFLEtBQUtzQyxvQkFBTCxDQUEwQnRDLElBQTFCLENBQStCLElBQS9CLENBQS9JO0FBQXFMLE1BQUEsUUFBUSxFQUFFLEtBQUtpQyx1QkFBTCxDQUE2QmpDLElBQTdCLENBQWtDLElBQWxDO0FBQS9MLE1BTkYsQ0FEQTtBQVVEOztBQXpHK0I7O0FBMEdqQztBQUNELGVBQWVYLEdBQWYsQyxDQUVBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vdmllcyBmcm9tICcuLi9kZWZhdWx0RGF0YS5qcyc7XG5pbXBvcnQgbW92aWVUaXRsZXNMaXN0IGZyb20gJy4vbW92aWVUaXRsZXNMaXN0LmpzJztcbmltcG9ydCBNb3ZpZU5hbWVzIGZyb20gJy4vTW92aWVOYW1lcy5qcyc7XG5pbXBvcnQgRm9ybSBmcm9tICcuL0Zvcm0uanMnO1xuaW1wb3J0IFdhdGNoZWQgZnJvbSAnLi9XYXRjaGVkLmpzJztcbmltcG9ydCBNb3ZpZUxpc3QgZnJvbSAnLi9Nb3ZpZU5hbWVzLmpzJztcbmNsYXNzIEFwcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yIChwcm9wcyl7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHRpdGxlczogW10sXG4gICAgICBjaG9vc2U6IFtdLFxuICAgICAgdW53YXRjaGVkTGlzdDogW10sXG4gICAgICB3YXRjaGVkTGlzdDogW11cbiAgICB9O1xuICAgIHRoaXMuc2hvd1VXID0gdGhpcy5zaG93VVcuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNob3dXID0gdGhpcy5zaG93Vy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZ2V0TW92aWVzID0gdGhpcy5nZXRNb3ZpZXMuYmluZCh0aGlzKTtcbiAgfVxuICBnZXRNb3ZpZXMoKSB7XG4gICAgdmFyIGFyciA9IFtdO1xuICAgIGF4aW9zLmdldCgnaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS9wb3B1bGFyP2FwaV9rZXk9NmUxZWNmMDg3MjJhYWQ0NjA0M2I5YTJjZDJmOTgyZWUmbGFuZ3VhZ2U9ZW4tVVMmcGFnZT0xJylcbiAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgIHJlc3BvbnNlLmRhdGEucmVzdWx0cy5tYXAoIChpdGVtLCBrZXkpID0+IHtcbiAgICAgICAgICBhcnIucHVzaCh7XG4gICAgICAgICAgICBpZCA6IGl0ZW0uaWQsXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5vcmlnaW5hbF90aXRsZSxcbiAgICAgICAgICAgIGRhdGU6IGl0ZW0ucmVsZWFzZV9kYXRlLFxuICAgICAgICAgICAgcGljdHVyZTogJ2h0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3c1MDAnICsgaXRlbS5wb3N0ZXJfcGF0aFxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7dGl0bGVzOiBhcnIsIHVud2F0Y2hlZExpc3Q6IGFycn0sICgpID0+IHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjaG9vc2U6IHRoaXMuc3RhdGUudGl0bGVzfSlcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3c1MDBcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnY291bGQgbm90IGdldCBtb3ZpZXMnKTtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gIH1cbiAgc2VuZE1vdmllcygpIHtcbiAgICBheGlvcy5wb3N0KCcvYXBpL21vdmllcycsIHRoaXMuc3RhdGUuY2hvb3NlKVxuICAgIC50aGVuKCAocmVzcG9uc2UpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdwYWNrYWdlIERFTElWRVJFRCcpO1xuICAgIH0pXG4gICAgLmNhdGNoKCAoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnTk9PT09PT08nKTtcbiAgICB9KVxuICB9XG5cbiAgY2hvb3NlTW92aWUobW92aWUpIHtcbiAgICB0aGlzLnNldFN0YXRlKCB7XG4gICAgICBjaG9vc2U6IG1vdmllXG4gICAgfSlcbiAgfVxuICBhZGRNb3ZpZShtb3ZpZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoIHtcbiAgICAgIHRpdGxlcyA6IFsuLi50aGlzLnN0YXRlLnRpdGxlcywgbW92aWVdLCB1bndhdGNoZWRMaXN0OiBbLi4udGhpcy5zdGF0ZS51bndhdGNoZWRMaXN0LCBtb3ZpZV1cbiAgICB9KVxuICB9XG4gIGFkZFRvV2F0Y2hlZChtb3ZpZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoIHtcbiAgICAgIHdhdGNoZWRMaXN0OiBbLi4udGhpcy5zdGF0ZS53YXRjaGVkTGlzdCwgbW92aWVdXG4gICAgfSlcbiAgfVxuICBhZGRUb1VuV2F0Y2hlZChtb3ZpZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoIHtcbiAgICAgIHVud2F0Y2hlZExpc3Q6IFsuLi50aGlzLnN0YXRlLnVud2F0Y2hlZExpc3QsIG1vdmllXVxuICAgIH0pXG4gIH1cbiAgcmVtb3ZlRnJvbVVuV2F0Y2hlZFdBcnIoa2V5KSB7XG4gICAgdmFyIG5ld0FyciA9IFsuLi50aGlzLnN0YXRlLnVud2F0Y2hlZExpc3RdO1xuICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUudGl0bGVzKTtcbiAgICB2YXIgaW5kZXggPSBuZXdBcnIuaW5kZXhPZih0aGlzLnN0YXRlLnVud2F0Y2hlZExpc3Rba2V5XSk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgbmV3QXJyLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB0aGlzLnNldFN0YXRlKHt1bndhdGNoZWRMaXN0OiBuZXdBcnJ9KTtcbiAgICB9XG4gIH1cbiAgcmVtb3ZlRnJvbVdhdGNoZWRBcnIoa2V5KSB7XG4gICAgdmFyIG5ld0FyciA9IFsuLi50aGlzLnN0YXRlLndhdGNoZWRMaXN0XTtcbiAgICB2YXIgaW5kZXggPSBuZXdBcnIuaW5kZXhPZih0aGlzLnN0YXRlLndhdGNoZWRMaXN0W2tleV0pO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIG5ld0Fyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7d2F0Y2hlZExpc3Q6IG5ld0Fycn0pO1xuICAgIH1cbiAgfVxuICBzaG93VVcoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y2hvb3NlOiB0aGlzLnN0YXRlLnVud2F0Y2hlZExpc3R9KTtcbiAgfVxuICBzaG93VygpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjaG9vc2U6IHRoaXMuc3RhdGUud2F0Y2hlZExpc3R9KTtcbiAgfVxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLmdldE1vdmllcygpO1xuICAgIHRoaXMuc2VuZE1vdmllcygpO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgIDxoMiBjbGFzc05hbWU9XCJsaW5rLWNvbnRhaW5lclwiPlxuICAgICAgPEZvcm0gbW92aWVzPXt0aGlzLnN0YXRlLnRpdGxlc30gc2VhcmNoTW92aWU9e3RoaXMuY2hvb3NlTW92aWUuYmluZCh0aGlzKX0gYWRkTW92aWU9e3RoaXMuYWRkTW92aWUuYmluZCh0aGlzKX0vPlxuICAgICAgPGRpdiBjbGFzc05hbWU9J2xzJz5Nb3ZpZUxpc3Q8L2Rpdj5cbiAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5zZW5kTW92aWVzLmJpbmQodGhpcyl9PlNlbmRNb3ZpZXM8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5zaG93VygpfT5XYXRjaGVkPC9idXR0b24+XG4gICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHRoaXMuc2hvd1VXKCl9PlVud2F0Y2hlZDwvYnV0dG9uPlxuICAgICAgPE1vdmllTGlzdCBtb3ZpZVRpdGxlPXt0aGlzLnN0YXRlLmNob29zZX0gYWRkVG9XYXRjaGVkPXt0aGlzLmFkZFRvV2F0Y2hlZC5iaW5kKHRoaXMpfSBhZGRUb1VuV2F0Y2hlZD17dGhpcy5hZGRUb1VuV2F0Y2hlZC5iaW5kKHRoaXMpfSByZW1vdmVXPXt0aGlzLnJlbW92ZUZyb21XYXRjaGVkQXJyLmJpbmQodGhpcyl9IHJlbW92ZVVXPXt0aGlzLnJlbW92ZUZyb21VbldhdGNoZWRXQXJyLmJpbmQodGhpcyl9IC8+XG4gICAgPC9oMj5cbiAgICApO1xuICB9XG59O1xuZXhwb3J0IGRlZmF1bHQgQXBwO1xuXG4vLyJdfQ==